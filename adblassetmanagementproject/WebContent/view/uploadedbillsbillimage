package com.adbl.daoimpl;
import java.sql.*;
import com.adbl.dao.InventoryDao;
import com.adbl.model.Inventory;
import com.mysql.jdbc.Connection;
import com.org.dbconnection.DBConnection;

public class InventoryDaoImpl implements InventoryDao {
	Connection con=null;
	Statement stmt=null;
	PreparedStatement ps=null;
	ResultSet rs=null;
	public InventoryDaoImpl(String branchdb) {
		con=DBConnection.getConnectionNext(branchdb);
	}
	public ResultSet getinventorydata(){
		String query="select * from inventorytbl";
		try{
			stmt=con.createStatement();
			rs=stmt.executeQuery(query);
		}
		catch(Exception e){
			System.out.println("getinventorydata error"+e);
		}
		return rs;
	}
	public ResultSet getinventoryeditdata(String itemcode){
		String query="select * from inventorytbl where itemcode='"+itemcode+"'";
		try{
			stmt=con.createStatement();
			rs=stmt.executeQuery(query);
		}
		catch(Exception e){
			System.out.println("geteditdata error"+e);
		}
		return rs;
	}
	public ResultSet getcompanylist(){
		String query="select * from companytbl";
		try{
			stmt=con.createStatement();
			rs=stmt.executeQuery(query);
		}
		catch(Exception e){
			System.out.println("getcompanylist error"+e);
		}
		return rs;
	}
	public ResultSet getfundsourcelist(){
		String query="select * from fundsourcetbl";
		try{
			stmt=con.createStatement();
			rs=stmt.executeQuery(query);
		}
		catch(Exception e){
			System.out.println("getfundsource error"+e);
		}
		
		return rs;
	}
	public ResultSet getgroup(){
        String query="select * from grouptbl";
        try{
            stmt=con.createStatement();
            rs=stmt.executeQuery(query);

        }
        catch(Exception e){
            System.out.println("getgroup error"+e);
        }
        
        return rs;
    }
	public ResultSet getitemcondition(){
        String query="select * from itemconditiontbl";
        try{
            stmt=con.createStatement();
            rs=stmt.executeQuery(query);

        }
        catch(Exception e){
            System.out.println("getgroup error"+e);
        }
        
        return rs;
    }
	public void addalldao(Inventory inventory) throws SQLException{
		String query1="insert into insurancetbl(insurancestart,companyid,insurancestarten,insuranceend,insuranceenden,insurancepremiumamount) "
				+ "values('"+inventory.getInsurancestart()+"',"+inventory.getInsurancecompanyid()+",'"+inventory.getInsurancestarten()+"','"+inventory.getInsuranceend()+"','"+inventory.getInsuranceenden()+"','"+inventory.getInsurancepremuimamount()+"')";
		String query2="insert into warrantytbl(warrantystart,warrantystarten,warrantyend,warrantyenden) "
				+ "values('"+inventory.getWarrantystart()+"','"+inventory.getWarrantystarten()+"','"+inventory.getWarrantyend()+"','"+inventory.getWarrantyenden()+"')";
		String query3="insert into amctbl(amcstart,amcstarten,amcend,amcenden,amccost,companyid)"
				+ "values('"+inventory.getAmcstart()+"','"+inventory.getAmcstarten()+"','"+inventory.getAmcend()+"','"+inventory.getAmcenden()+"','"+inventory.getAmccost()+"',"+inventory.getAmccompanyid()+")";
		try{
			stmt=con.createStatement();
			
			stmt.addBatch(query1);
			stmt.addBatch(query2);
			stmt.addBatch(query3);
			stmt.executeBatch();
		}catch(Exception e){
			System.out.println(e);
		}
		finally{
			if(stmt!=null){
				stmt.close();
			}
		}
	}
	public String[] selectids() throws SQLException{
		String[] ids=new String[3];
		String query="SELECT max(amcid) as amcid ,max(warrantyid) as warrantyid ,max(insuranceid) as insuranceid from amctbl, warrantytbl, insurancetbl";
		try{
			ps=con.prepareStatement(query);
			rs=ps.executeQuery();
			while(rs.next()){
				ids[0]=rs.getString("amcid");
				ids[1]=rs.getString("warrantyid");
				ids[2]=rs.getString("insuranceid");
			}
			
		}
		catch(Exception e){
			System.out.println(e);
		}
		finally{
			if(ps!=null){
				ps.close();
			}
		}
		return ids;
	}
	public String selectadditionaldetailid() throws SQLException{
		String id="";
		String query="SELECT max(inventoryotherdetailid) as additionaldetailid from inventoryotherdetailtbl";
		try{
			ps=con.prepareStatement(query);
			rs=ps.executeQuery();
			while(rs.next()){
				id=rs.getString("additionaldetailid");
			}
		}
		catch(Exception e){
			System.out.println(e);
		}
		finally{
			if(ps!=null){
				ps.close();
			}
		}
		return id;
	}
	public String insuranceid(){
		String query="select max(insuranceid) from insurancetbl";
		String insuranceid="";
		try{
			ps=con.prepareStatement(query);
			rs=ps.executeQuery();
            while(rs.next()){
            	insuranceid=rs.getString("max(insuranceid)");
            }
            
		}
		catch(Exception e){
			
		}
		return insuranceid;
	}

	public String warrantyid(){
		String query="select max(warrantyid) from warrantytbl";
		String warrantyid="";
		try{
			ps=con.prepareStatement(query);
			rs=ps.executeQuery();
            while(rs.next()){
            	warrantyid=rs.getString("max(warrantyid)");
            }
            
		}
		catch(Exception e){
			
		}
		return warrantyid;
	}

	
	public String amcid(){
		String query="select max(amcid) from amctbl";
		String amcid="";
		try{
			ps=con.prepareStatement(query);
			rs=ps.executeQuery();
            while(rs.next()){
            	amcid=rs.getString("max(amcid)");
            }
            
		}
		catch(Exception e){
			
		}
		return amcid;
	}
	
	public void additionaldetaildao(Inventory inventory,String[] ids) throws SQLException {
		String query="insert into inventoryotherdetailtbl(fundsourceid,unitname,rate,quantity,amount,warrantyid,amcid,insuranceid,supplierid,itemconditionid,itemsize,macaddress,licenseno,vehicleno,chesisno,engineno) "
				+ "values("+inventory.getFundsource()+",'"+inventory.getUnitname()+"','"+inventory.getRate()+"','"+inventory.getQuantity()+"','"+inventory.getAmount()+"','"+ids[1]+"','"+ids[0]+"','"+ids[2]+"',"+inventory.getSupplierid()+","+inventory.getItemconditionid()+",'"+inventory.getItemsize()+"','"+inventory.getMacaddress()+"','"+inventory.getLicenseno()+"','"+inventory.getVehicleno()+"','"+inventory.getChesisno()+"','"+inventory.getEngineno()+"')";	
		try {
			ps=con.prepareStatement(query);

			ps.executeUpdate();
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	public boolean inventorydao(Inventory inventory,String additionaldetailid)
	{
		boolean status=false;
		int a;
		String query="insert into inventorytbl(itemcode,transactionid,legacyid,groupcode,itemname,model,decisiondate,decisiondateen,purchasedate,purchasedateen,depreciationrate,inventoryotherdetailid) "
				+ "values('"+inventory.getItemcode()+"','"+inventory.getTransactionid()+"','"+inventory.getLegacyid()+"','"+inventory.getGroupcode()+"','"+inventory.getItemname()+"','"+inventory.getModel()+"','"+inventory.getDecisiondate()+"','"+inventory.getDecisiondateen()+"','"+inventory.getPurchasedate()+"','"+inventory.getPurchasedateen()+"','"+inventory.getDepreciationrate()+"','"+additionaldetailid+"')";
		try {
			ps=con.prepareStatement(query);

			a=ps.executeUpdate();
			if(a>0){
				status=true;
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return status;
	}
	public boolean editalldao(Inventory inventory,String additionaldetailid)
	{
		int rs=0;
		
		String query="update inventorytbl set transactionid=?,legacyid=?,groupcode=?,itemname=?,model=?,decisiondate=?,decisiondateen=?,purchasedate=?,purchasedateen=?,depreciationrate=?,inventoryotherdetailid=? where itemcode=?";
		
		try {
			ps=con.prepareStatement(query);
			ps.setString(1, inventory.getTransactionid());
			ps.setString(2, inventory.getLegacyid());
			ps.setString(3, inventory.getGroupcode());
			ps.setString(4, inventory.getItemname());
			ps.setString(5, inventory.getModel());
			ps.setString(6, inventory.getDecisiondate());
			ps.setString(7, inventory.getDecisiondateen());
			ps.setString(8, inventory.getPurchasedate());
			ps.setString(9, inventory.getPurchasedateen());
			ps.setString(10, inventory.getDepreciationrate());
			ps.setString(11, additionaldetailid);
			ps.setString(12, inventory.getItemcode());
			rs=ps.executeUpdate();
			if(rs>0)
			{
				System.out.println("success updating");
				return true;
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return false;
		
		
		
	}
	
}
PK     ! 2oWf     [Content_Types].xml (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 j0EѶJ(ɢ?eh4NDB81$14 {1ښl	w%=?^i7+-d&0A6l4L60#ÒS
OX *?V$:B~^?Kڃ
/PI~7$iJ&B0ZDutOJK(HxG
L+vdcӻW>*\XRmpZ}HwnMVn-")/ZwB`4?	sDXj;A*??c? 4[S9> ?{V4pW&A|d?    PK     !    N   _rels/.rels (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 j0@ѽQN/c[ILj<]aGӓzsFu]U
	^[x 1xpf#I)ʃY*Di")c$qU~31jH[{=E~
f?3-??޲]Tꓸ2?j),l0/%b
zŉ,		/|f\Z?6!Y_o]A   PK     !      word/_rels/document.xml.rels (                                                                                                                                                                                                                                                                 j0{-;mC	s)?\[d{CcMZ}EJӃ3bgz;5$uoZ'ijA#zw7T??bhXqЄ:-)HAVEH%wȯ2ٮv#b?ٶi
_mhFH6!SIIB4*\}u.l|!8[s˘fpf6
Y	ٚx	'~    PK     ! R	  +     word/document.xml]r۸ޙF3/Q?lzՖirZu8 (Uy>K )ۊȑmH$b~? c
WةW?
*޽=cPUT~=~Cd	 	iړ48֦Z1KIxQCCD֬7[U?:ToI(*?P:%T?-PO.?~IFU2-3J;g(kUͫp-4&u7~%]?'|n63M'qMpüR"rب0"HbVcnYrP.!nu?yikz.hF}Z Y?~LS@`/"4	u,@SLɤ
+<N}Q)o?!̈́ŒVp5Ӟ Zg2@z	k..3lfVUjXM;%& +0C~cr*6ƞN',oo@	1/ˋn@0u^.\@;jEk31Ng
T%֖Ĥm?;<D??mH.*^Ө]LrA FTҸm lͽgya>;`<$:76poqCybeQ\jgE#مh\AJ4q"?!a촵EB8sK0̾4ҞEm
8ΎS͘&
tcߪdQ[[KWG_;#%
wDZ
1$bJG?l	1<)#*WࣂR?_h5g2LVEmL-Q!ӆhfRSU$/j@6Ct<HLRF:/mx00
HLAbL?Y>
(ymZl̄J?֡p"&6.~yo
D)
FVe_Yrb?FݬS|6l@MG-+mҴ>Oip%2rk߯}l tsRnQu0̸d r?HA%'Q@İz12J4y߫N?(``zY`z	AAոN+0 $Q皆ۨwO(xQX<g1?7LgG0UîF4J&eB-նPm+SVNW%:Ev礅ܘj߰UF8DHUM@禂ۓן!ӜTJ?pA@4>W8*:Ǘ?׿v\1,$o4$S?,bH<E?5<}}iYJc'ŧnM#?';U7!9\~sƭSvq}łX
w&o]7x}&|ji$`T"0,Nt޼tLMD瘖n_5f%o4	yNwZ?VmX%wI嬵pP,I-}hvwJitg觸^%}Vwgax:5z`kLQF8Q2`?,p%!,A@|97	?nKv?QÊƸMs5&/o/,oI}4yo>eof2?]QlIG>2|#`E
ݣL<<6?-Zsh~2B*0xlxll'_baIph`qL;n=P^<CB	{<Dg)"['9&E!8?7#?ƻs7.$p?LZ		,Eɒ@ViQ5S?סms6vZ
y+;=lݔ]|O+SKnǳcj@zJ[*慳ՊgSp/&?O*ds􋷭w֫	>eܽgFr[Lu?N~p=]ز=0	d#Б-`yG+D?jR!j2CQ͹r+XiP`٦2P.?71Η?ݣxDM-[涡]w#wB D>`,r=dr7e2w?t9DپPc߮peK%K}&4['1x7Y">'|Zj?0LTC2~fx[oU$aLͶ*7/MJ_(r2}ۦ?ߩNMzWLz. ^/(/(/(/(/GԲo7?BU[k{p?q}X٪?Q@Y|媼
qPJ2pQ2+"bEmUp[
W:P}?* <?    PK     ! R%#       word/theme/theme1.xmlYM7c7c;i&%GyFQI]%9
i?z(m	mSxlɖYl`)YZJ?4WN㘦z 4iqK-p3GܹᎈQO8?rKtR7,?BVYT<~RU*?rq&f.?YC@A
Ns0pIǑ?ȅ8w/FDloa0'5eǢu=]W "6q1h,) 9Ӝz^[`5P^7?7]/xʋ~8W1@yѳĤY]@y?oV}i(&8?l+^]BƔ\۞;l>ZS6 \(p
|0?8<b(o
SesVVqUIE YMh 0<c o^sp_N?>}L#_S^?ʎ:>/@_}?^}?<t!N71M91 h?anM#SXsHCf2)6}Af[ SJzYt=K?,?샳
ml-TwlsȠyȔH?N؈>t,=z[CrGjZ]ÉFPۈ]У?L?\"b*	XÄ=(bɃ9s!3!B DlnA{<1L
)Ց}:cLq?D.QnQa%Ae`5w12}޾#վ@m	D8'c'8=Sd{.շO{!˰uG6ܺxkw[Hntto/+?V⪮$[cL?Ǖs9p(UE-,.3p`p*"pq0\; dykZ<J(V|)i$FstjzT.d6In!, fv.,Vk ~ܜ\o?0Sn_d3-k3iL2a֛9UJ
zY(6i4["יiI8{I7vb2x?Di	"EY>qS],'ri [xAɵ+/rKO2?Q /wb}KpV3I ?m(5Y C2!f^EqM[lE!pqbUyIGb>+(ʒ֧FY&[?Դǻ;5V+7XҽuB?o hV2jV9^Ksqާ^j&\}y]?Ut"G\	Tk.'8*^k_AɭRK]ϫW^ʠ8zC<C7/}KR\/4)Su.+cZ`?ڰ]ov;,^R7þÇ8R`[ƠUjT}6*Vtkn"rw^k    PK     ! vy  
     word/settings.xmlVm?6^sY@6:iUpMU;tp7?F{4|D7a05Y)mς#zw46 \p?j쌑hfH92#s#`RJqatn,h:CF*%k͆TꚸRT
ܸ#) 7No]bϨ;D=UZ\5?JTXkx F}?'8z?}+:W`ty_9#)R-Ok*{rPI?p?d-LbU 0Y *"6A%ԑ?CU=xjPY!Ai? wY?B?o?wa@u/Y8SqzDGјh
<pfg?56\_|k?HPO9Re
yцG.ߑ[	`n#<%12
s/S"D)x
\af 5Љ(qpuQ
;NiƫaqE{$&	t&?BE_㌣pu{Y$Q$q<N/zKo}Gsd:bN/Y&t9<wFe?(2`R4X?0z'%O)=8f\j,KqgFj4E)L?d7%٢d^%L:K#a^V	^:9d#rMt1~.k$e76lw&T7UQn@hw^{ىƽle^xYR/KlK:yG+JzQ[C/m[?z2\$z?7
Ԛw-3]YeyFqf(U.vVXY/6qJ4<	{_%Y-ڮVW:OQr.pr;^
|!̧8?ÿN/   PK     ! )=e  m     word/webSettings.xmln0H$N7"dɮ6 h4mQ܅\9'/%=NNdkeJ>ϣG8OuN%hwd[Iͳw=tRKKIIб+`bVQ?W[?1Pz	)!hF:E! )}-H*a܉VB<Jy
}LW %0]G-
㓨UJ^  XRj4$@YrwԉS2?O8zaT~Iظ?W^?7QV[0>ֹmd4~9/yC4	ppD^gÒٯem!2QN׊O   PK     ! ?Z35   p     word/styles.xml?]S:j+W0?ag\+BV_IvI?+K*_</F{gJDx6pq%&UF(_%/"
Ȋ4>rq[sZL9SyJ2MYT-vb.X)Buwox`>5Qq9b.Œ܇dTּlP*\jV~;Ȣtx5_1S9J='?>OTX%¼eVYYDϧx-kH*4<+HYQo^5sȸ(?"]h_/&F-$xcv4ܳw&&pٷǋl\'x@0i{eUj
]Im.}UO&~ldB:FlzㄧF$	Ϝfss(xMfCLp2 %݌M i>]u6?KظQ-~Ι[>
o"
goۙ՛}B5t^
WCG{5t^
}|,?R68799/99'9DGs<yx)UB'<~n?$q¸'0=}:nø'k<^jEfY9e3L<*p4F4<s9N`ꙭ9̾ޞ!֤rE3X庞qRWK#漬rψtg<Y)j*()An.#g	-$*u<7&I?8WûU@JJNFb56?,fxahF5D
?hр54qjѸ54qkhANcݥTT~Lc`9gݳ=l1?̉vv.T=PV$uMK"?\+V<"x-vf?vCSLijZKe	U6VϰE^?٠K?rI1{9ckp[?H 	z)UD3
߼.x˲k%z	qR5V^JsV[+m ;CF?	ѭ nFjaL304U*%c6gONs]gD{{Ntz.A&"$P'?*'4?8a^txKϋz!X
Y޿X.y!*S=?ӆE57?OuTDrf?RF/6p×VM}x0K;?KɊBx/vwɣ_SRJ
H6K *YYAǖGÖG)cy,Hİ0*%,JH~~~N
#Z80<#=]q`TyfaTyfaTyfaTyv%ⳙ^b$U9HMVtr!$d'Hk}f?7q 9jIخqT"SeΈ2)":>{׶'9w^ϕLx''cooW8/|um?\al,maw<U(|?FQH*y#g$lcH?.?|aSk"tϪ$IW[JUd[
teцU86W:<?g<E~
N~Jo_]	sdL`޷^3矕o\pP׭^8e?Z9/\m2q=?G)O=7')?=[#n
ƇV?2[
X~ڨ?6ꀕ?2*2*?
hBڨp3*ƇRB
)hBڨ?6*D?
hAFQ!mT@ծ
C
)!FQ!mT@"FQ!eTdTHA"FQG
?
qF!FB
ڨ?6*D?
hBڨ?2*2*?
hBڨb xQa|Q!%Ĩ?6*D?
hBڨ?6*D

)hBڨѕ%JmcYO/]5?>?pS?7AT
eOQ{.\{KO?_<aaHpN+HPve	V?]	]}8]ӌ<wN89	#53;?pc'(2裞t!	]i	ZN}E'O@
QaRCa7p!*Xj
NX!+u'I
0RCT&5<a?zً	0+5$`?$5K
QRCTԠJFK
	X!+5$I
0RCT%=!5Ja'sqd'79;?ՒX-9j	jW-	}'bQh0qRFR%ԸjSj\)5ZK?ڤUKmRO~B?ԸjSj\)5ZK?ڤUKmR㪥6?pqRԸj/5ZjW-I?ڤUK^qRԸjSj\W-I?ڤUKmR%ԸjSj\)Z}&öI?\.n?"m$lz5?Iln.-@T<mͷ'yju?Է
{*vd=O7CZnggK3}tQ4CݟKs%`U(%՟VG%=ys;Qx?_6?+ޔ4nhn{;Б^m_    PK     ! .#D     docProps/core.xml (                                                                                                                                                                                                                                                                 _k0%mn+mm4a0Br`$ZkVE{bU5%A	a2}&JBF(B\X:QAH'rJCk_`Ŋ/ a
K9n
S;[3?CLf^?rFjwnGA`]Y=&??nT+R?ֳ6J+|&5V<i\?|]D;a7c?š
 &x_|_f>9}ȇ4'
w12ԇ v<.a    PK     ! -  p&     word/numbering.xmlZ[n8/0{0iI1@2mC iK&f??B)RQgC_xyϹ<Lo}#\ F9=H3@t5t.R'$C
otC??=A`gCg-e>p]!⒠32ce%ʠc|飜
pƀn?pJ8??q:+ u_(H4G;:N%E]P20MkR&,Hft9ĪFi
d6-ո]G/[	;R$l*oG'HQg<CΪ$MC\<>@z&ߣЯ5Vqk?\ˊI6YQԒv倹?dnCC@,([DKB|{jE%IXjM'Ql"x[?j*.e\dfr;o:up>ox@"ǳ	s&0	&M? 	܃۽?t:&qrL?4:/輠&uj??L'IP7gyA?e?^?Ӹ:/	:/-{Ay4 NGh2*'/P^0MKr^?Q?O~_^qE u=je[?Q:ΙPSS?/pLT?]?A5Fe3cTBR!4t>ߑ9:u=@T+J8S.F>gPB*?D[XR:l?b~11u61CkLV1mbFiSmoQaČmz:lb& MV1ï/`@>?6'lTuif{|4-jI3ޣiaKڃHGhZ%ձ4<oS    PK     ! n       word/fontTable.xmlܒ]k0B?eS?E YmQ}%^?6K;񃯮M҃r6Q"pke|X],(?kgeNw㇫6+?
@p̈!4Y?0q?X,?7<૯"㦹4<BivQ،
ŕ#mG^j$:j`OkOίo6z&N?@F	a3vԣp{πy	`DB| .G,7Xߙ>ou c,m)Y՜9esuE=Ȏ1,LF>p;DϷܫ
COu$Gk.sIb

D<(#??-;Hc.Dwu#In{NnWg#7/GF>H?p
0
t#EY&U $?O仪?;1N`   PK     ! 
     docProps/app.xml (                                                                                                                                                                                                                                                                 Sn0?ǔܤ?fP8(rhV3KlI?#w)*T?feb2ޭXYNθ݊=.޳*r?!D ?TK+Gל'A;:}Rwp rxAptadW:K?1?-*5i	zT5Ȇ9$>c zH͓2B|?*}=V*^*`9<Z2?#
"oQ
{2
ΑjeaM^&<?2*4%c+vP(lJ?0֠%9aVbs;;?1=>w7?{
a)͎&??T~QChm^_=<'?oy:r#%:<wTB;}?wqzZ?Kth7$   PK-      ! 2oWf                     [Content_Types].xmlPK-      !    N                 _rels/.relsPK-      !                    word/_rels/document.xml.relsPK-      ! R	  +               	  word/document.xmlPK-      ! R%#                   word/theme/theme1.xmlPK-      ! vy  
               K  word/settings.xmlPK-      ! )=e  m               _  word/webSettings.xmlPK-      ! ?Z35   p                 word/styles.xmlPK-      ! .#D                 C*  docProps/core.xmlPK-      ! -  p&               ,  word/numbering.xmlPK-      ! n                 0  word/fontTable.xmlPK-      ! 
                 2  docProps/app.xmlPK        5    
